<!DOCTYPE html>
<html lang="pt-BR">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Teste Content ID Fix - TikTok Events</title>
    <!-- TikTok Pixel Code Start -->
<script>
!function (w, d, t) {
  w.TiktokAnalyticsObject=t;var ttq=w[t]=w[t]||[];ttq.methods=["page","track","identify","instances","debug","on","off","once","ready","alias","group","enableCookie","disableCookie","holdConsent","revokeConsent","grantConsent"],ttq.setAndDefer=function(t,e){t[e]=function(){t.push([e].concat(Array.prototype.slice.call(arguments,0)))}};for(var i=0;i<ttq.methods.length;i++)ttq.setAndDefer(ttq,ttq.methods[i]);ttq.instance=function(t){for(
var e=ttq._i[t]||[],n=0;n<ttq.methods.length;n++)ttq.setAndDefer(e,ttq.methods[n]);return e},ttq.load=function(e,n){var r="https://analytics.tiktok.com/i18n/pixel/events.js",o=n&&n.partner;ttq._i=ttq._i||{},ttq._i[e]=[],ttq._i[e]._u=r,ttq._t=ttq._t||{},ttq._t[e]=+new Date,ttq._o=ttq._o||{},ttq._o[e]=n||{};n=document.createElement("script")
;n.type="text/javascript",n.async=!0,n.src=r+"?sdkid="+e+"&lib="+t;e=document.getElementsByTagName("script")[0];e.parentNode.insertBefore(n,e)};

  ttq.load('D1QFD0RC77UF6MBM48MG');
}(window, document, 'ttq');
</script>
<!-- TikTok Pixel Code End -->
    <style>
        body {
            font-family: Arial, sans-serif;
            max-width: 800px;
            margin: 0 auto;
            padding: 20px;
        }
        .test-section {
            margin: 20px 0;
            padding: 20px;
            border: 1px solid #ddd;
            border-radius: 8px;
        }
        button {
            background: #4CAF50;
            color: white;
            padding: 10px 20px;
            border: none;
            border-radius: 4px;
            cursor: pointer;
            margin: 5px;
        }
        button:hover { background: #45a049; }
        .results {
            margin-top: 10px;
            padding: 10px;
            background: #f9f9f9;
            border-radius: 4px;
            font-family: monospace;
            white-space: pre-wrap;
        }
        .error { color: red; }
        .success { color: green; }
        .warning { color: orange; }
    </style>
</head>
<body>
    <h1>üîß Teste de Corre√ß√£o Content ID - TikTok Events</h1>
    <p>Esta p√°gina testa se a corre√ß√£o do par√¢metro <code>content_id</code> est√° funcionando corretamente.</p>

    <div class="test-section">
        <h2>üìä Status do Sistema</h2>
        <button onclick="checkSystemStatus()">Verificar Status</button>
        <div id="status-results" class="results"></div>
    </div>

    <div class="test-section">
        <h2>üß™ Teste Content ID V√°lido</h2>
        <button onclick="testValidContentId()">Testar com Content ID V√°lido</button>
        <div id="valid-results" class="results"></div>
    </div>

    <div class="test-section">
        <h2>‚ö†Ô∏è Teste Content ID Vazio/Inv√°lido</h2>
        <button onclick="testInvalidContentId()">Testar com Content ID Vazio</button>
        <button onclick="testNullContentId()">Testar com Content ID Null</button>
        <button onclick="testUndefinedContentId()">Testar com Content ID Undefined</button>
        <div id="invalid-results" class="results"></div>
    </div>

    <div class="test-section">
        <h2>üöÄ Teste Navega√ß√£o Steps (Cen√°rio Original)</h2>
        <button onclick="testNavigationSteps()">Testar Navega√ß√£o Entre Etapas</button>
        <div id="navigation-results" class="results"></div>
    </div>

    <div class="test-section">
        <h2>üéØ Teste M√©todos Create</h2>
        <button onclick="testCreateMethods()">Testar M√©todos de Cria√ß√£o</button>
        <div id="create-results" class="results"></div>
    </div>

    <script src="js/tiktok-events-v3.js"></script>
    <script>
        function log(elementId, message, type = 'info') {
            const element = document.getElementById(elementId);
            const timestamp = new Date().toLocaleTimeString();
            const className = type === 'error' ? 'error' : type === 'success' ? 'success' : type === 'warning' ? 'warning' : '';
            element.innerHTML += `<div class="${className}">[${timestamp}] ${message}</div>`;
        }

        function checkSystemStatus() {
            const results = document.getElementById('status-results');
            results.innerHTML = '';
            
            log('status-results', 'üîç Verificando status do sistema...');
            
            if (typeof window.TikTokManager !== 'undefined') {
                log('status-results', '‚úÖ TikTokManager est√° dispon√≠vel', 'success');
                
                if (typeof window.TikTokManager.trackViewContent === 'function') {
                    log('status-results', '‚úÖ M√©todo trackViewContent est√° dispon√≠vel', 'success');
                } else {
                    log('status-results', '‚ùå M√©todo trackViewContent n√£o encontrado', 'error');
                }
                
                if (typeof window.TikTokEvents !== 'undefined') {
                    log('status-results', '‚úÖ TikTokEvents est√° dispon√≠vel', 'success');
                } else {
                    log('status-results', '‚ö†Ô∏è TikTokEvents n√£o est√° dispon√≠vel', 'warning');
                }
            } else {
                log('status-results', '‚ùå TikTokManager n√£o est√° dispon√≠vel', 'error');
            }
            
            if (typeof ttq !== 'undefined') {
                log('status-results', '‚úÖ TikTok Pixel est√° carregado', 'success');
            } else {
                log('status-results', '‚ùå TikTok Pixel n√£o est√° carregado', 'error');
            }
        }

        async function testValidContentId() {
            const results = document.getElementById('valid-results');
            results.innerHTML = '';
            
            log('valid-results', 'üß™ Testando com content_id v√°lido...');
            
            try {
                const result = await window.TikTokManager.trackViewContent(
                    'test_valid_content_123', 
                    'Teste Content ID V√°lido', 
                    10, 
                    'BRL', 
                    'product'
                );
                log('valid-results', `‚úÖ Evento enviado com sucesso: ${JSON.stringify(result)}`, 'success');
            } catch (error) {
                log('valid-results', `‚ùå Erro ao enviar evento: ${error.message}`, 'error');
            }
        }

        async function testInvalidContentId() {
            const results = document.getElementById('invalid-results');
            results.innerHTML = '';
            
            log('invalid-results', '‚ö†Ô∏è Testando com content_id vazio...');
            
            try {
                const result = await window.TikTokManager.trackViewContent(
                    '', // Content ID vazio
                    'Teste Content ID Vazio', 
                    5, 
                    'BRL', 
                    'product'
                );
                log('invalid-results', `‚úÖ Evento enviado (ID gerado automaticamente): ${JSON.stringify(result)}`, 'success');
            } catch (error) {
                log('invalid-results', `‚ùå Erro ao enviar evento: ${error.message}`, 'error');
            }
        }

        async function testNullContentId() {
            const results = document.getElementById('invalid-results');
            
            log('invalid-results', '‚ö†Ô∏è Testando com content_id null...');
            
            try {
                const result = await window.TikTokManager.trackViewContent(
                    null, // Content ID null
                    'Teste Content ID Null', 
                    5, 
                    'BRL', 
                    'product'
                );
                log('invalid-results', `‚úÖ Evento enviado (ID gerado automaticamente): ${JSON.stringify(result)}`, 'success');
            } catch (error) {
                log('invalid-results', `‚ùå Erro ao enviar evento: ${error.message}`, 'error');
            }
        }

        async function testUndefinedContentId() {
            const results = document.getElementById('invalid-results');
            
            log('invalid-results', '‚ö†Ô∏è Testando com content_id undefined...');
            
            try {
                const result = await window.TikTokManager.trackViewContent(
                    undefined, // Content ID undefined
                    'Teste Content ID Undefined', 
                    5, 
                    'BRL', 
                    'product'
                );
                log('invalid-results', `‚úÖ Evento enviado (ID gerado automaticamente): ${JSON.stringify(result)}`, 'success');
            } catch (error) {
                log('invalid-results', `‚ùå Erro ao enviar evento: ${error.message}`, 'error');
            }
        }

        async function testNavigationSteps() {
            const results = document.getElementById('navigation-results');
            results.innerHTML = '';
            
            log('navigation-results', 'üöÄ Testando navega√ß√£o entre etapas (cen√°rio original)...');
            
            try {
                if (typeof window.TikTokEvents !== 'undefined' && window.TikTokEvents.create) {
                    const result = await window.TikTokEvents.create.navigateSteps(1, 2);
                    log('navigation-results', `‚úÖ Navega√ß√£o testada com sucesso: ${JSON.stringify(result)}`, 'success');
                } else {
                    log('navigation-results', '‚ùå TikTokEvents.create n√£o est√° dispon√≠vel', 'error');
                }
            } catch (error) {
                log('navigation-results', `‚ùå Erro ao testar navega√ß√£o: ${error.message}`, 'error');
            }
        }

        async function testCreateMethods() {
            const results = document.getElementById('create-results');
            results.innerHTML = '';
            
            log('create-results', 'üéØ Testando m√©todos de cria√ß√£o...');
            
            const tests = [
                { method: 'viewCreateStep', args: [1, 'Etapa Teste'] },
                { method: 'viewCreateContent', args: ['test_content', 'Conte√∫do Teste'] },
                { method: 'viewCreatePreview', args: ['test_card_123'] }
            ];

            for (const test of tests) {
                try {
                    if (window.TikTokEvents && window.TikTokEvents[test.method]) {
                        const result = await window.TikTokEvents[test.method](...test.args);
                        log('create-results', `‚úÖ ${test.method}: ${JSON.stringify(result)}`, 'success');
                    } else {
                        log('create-results', `‚ùå M√©todo ${test.method} n√£o encontrado`, 'error');
                    }
                } catch (error) {
                    log('create-results', `‚ùå Erro em ${test.method}: ${error.message}`, 'error');
                }
            }
        }

        // Verificar status automaticamente ao carregar
        document.addEventListener('DOMContentLoaded', () => {
            setTimeout(checkSystemStatus, 1000);
        });
    </script>
</body>
</html>
