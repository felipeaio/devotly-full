server {
    listen 80 default_server;
    listen [::]:80 default_server;
    server_name www.devotly.shop devotly.shop;
    root /usr/share/nginx/html;
    index home.html index.html;
    
    # Configuração básica
    location / {
        try_files $uri $uri/ /home.html;
    }
    
    # Configuração para rotas específicas - manter na mesma ordem de prioridade
    location = /create {
        try_files $uri /create/create.html;
    }
    
    location = /edit {
        try_files $uri /edit/edit.html;
    }
    
    location = /view {
        try_files $uri /view/view.html;
    }
    
    location = /termos {
        try_files $uri /termos.html;
    }
    
    location = /privacidade {
        try_files $uri /privacidade.html;
    }
    
    location = /success {
        try_files $uri /success.html;
    }
    
    # Servir arquivos estáticos diretamente
    location ~* \.(html|css|js|jpg|jpeg|png|gif|ico|svg|woff|woff2|ttf|eot)$ {
        access_log off;
        expires 30d;
        try_files $uri =404;
    }
    
    # Para requisições à API, redirecionar para o backend
    location /api/ {
        # Redireciona para o backend no Railway
        return 307 https://devotly-full-production.up.railway.app$request_uri;
    }
    
    # Error pages customizados
    error_page 404 /home.html;
    error_page 500 502 503 504 /home.html;
    
    # Compression para melhorar performance
    gzip on;
    gzip_types text/plain text/css application/json application/javascript text/xml application/xml text/javascript;
    gzip_min_length 1000;
}
